!function(){window.console||(window.console={});for(var e=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"],t=0;t<e.length;t++)window.console[e[t]]||(window.console[e[t]]=function(){})}(),function(e,t){document.domain="ubi.com";var s={acl:[]},o=function(e){function o(e){try{tc_events_100(this,"pageevent",{ACTION:e.ACTION,SITESECTION:e.SITESECTION,SUBSITESECTION:e.SUBSITESECTION,COUNTRY:e.COUNTRY,LANGUAGE:e.LANGUAGE,ERRORCODE:e.ERROR})}catch(t){console.warn("unable to send tc event"),console.warn(t)}}function r(e){for(var t=e+"=",s=document.cookie.split(";"),o=0;o<s.length;o++){for(var r=s[o];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}function a(e,t){var s=new Date;s.setTime(s.getTime()+24*E.createDays*60*60*1e3);var o="; expires="+s.toGMTString();document.cookie=e+"="+t+o+";path=/"}function n(e){var t=new Date;t.setTime(t.getTime()+24*E.expireDays*60*60*1e3);var s="; expires="+t.toGMTString();document.cookie=e+"="+s+";path=/"}function i(e,s){var o;o=s!==t?(new Date).getTime()+100:(new Date).getTime()+5e3;var r=new Date(o),a=r.toUTCString();E.createC("lock",a)}function c(e){E.deleteC("lock")}function u(e){var t=E.readC("lock");if(t)try{if(t=new Date(t),new Date<t)return!0;E.disableLock(e)}catch(s){E.disableLock(e)}return!1}function l(e,t){E.isLockEnabled(t)?setTimeout(function(){E.waitForLock(e,t)},100):e()}function f(o,r,a,n,i){E.endpoint=o,E.local=r,E.swf=a,E.acl=n!=t?n:s.acl,E.enableLock(null,!0),E.socket=new easyXDM.Socket({local:E.local,swf:E.swf,acl:E.acl,onMessage:function(s,o){E.waitForLock(function(){E.enableLock(s);var o={op:""};try{o=JSON.parse(s)}catch(r){console.warn("onMessage"),console.warn(s),console.warn(r)}switch(o.op){case"check":E.checkThirdParty(function(e){e.success?E.socket.postMessage(JSON.stringify({op:"check",status:"OK",ref:o.ref,value:e.data})):E.socket.postMessage(JSON.stringify({op:"check",status:"FAILED",ref:o.ref,value:e.data}))});break;case"getTicket":E.validateTicket(o.appId,o.genomeId,null,null,function(e){e.success?E.configValidation(o.appId,o.genomeId,e.data.ticket,function(t){t.success?null!=t.data&&t.data.ageGatePassed?E.socket.postMessage(JSON.stringify({op:"getTicket",status:"OK",ref:o.ref,ticket:e.data.ticket,token:e.data.token,user_id:e.data.userId,sessionId:e.data.sessionId,expiration:e.data.expiration})):E.socket.postMessage(JSON.stringify({op:"getTicket",status:"FAILED",ref:o.ref,msg:"age gate failed"})):E.socket.postMessage(JSON.stringify({op:"getTicket",status:"FAILED",ref:o.ref,msg:null!=t.error?t.error.message:""}))}):E.socket.postMessage(JSON.stringify({op:"getTicket",status:"FAILED",ref:o.ref,msg:null!=e.error?e.error.message:""})),setTimeout(function(){E.disableLock(s)},200)});break;case"getProfile":var a=o.ticket;if((null==a||""===a||a===t)&&(a=e.cookie("ticket")),null==a||""===a||a===t){E.socket.postMessage(JSON.stringify({op:"getProfile",status:"FAILED",ref:o.ref,msg:"invalid ticket"}));break}E.getProfile(o.appId,o.genomeId,a,function(e){e.success?E.socket.postMessage(JSON.stringify({op:"getProfile",status:"OK",ref:o.ref,user:e.data})):E.socket.postMessage(JSON.stringify({op:"getProfile",status:"FAILED",ref:o.ref,msg:null!=e.error?e.error.message:""}))});break;case"getProfiles":var a=o.ticket;if((null==a||""===a||a===t)&&(a=e.cookie("ticket")),null==a||""===a||a===t){E.socket.postMessage(JSON.stringify({op:"getProfiles",status:"FAILED",ref:o.ref,msg:"invalid ticket"}));break}var n=o.userId;if((null==n||""===n)&&(n=e.cookie("user_id")),null==n||""===n){E.socket.postMessage(JSON.stringify({op:"getProfiles",status:"FAILED",ref:o.ref,msg:"invalid userId"}));break}E.getProfiles(o.appId,o.genomeId,a,n,function(e){e.success?E.socket.postMessage(JSON.stringify({op:"getProfiles",status:"OK",ref:o.ref,user:e.data})):E.socket.postMessage(JSON.stringify({op:"getProfiles",status:"FAILED",ref:o.ref,msg:null!=e.error?e.error.message:""}))});break;case"getUserData":var i=o.ticket;if((null==a||""===a||a===t)&&(a=e.cookie("ticket")),null==a||""===a||a===t){E.socket.postMessage(JSON.stringify({op:"getUserData",status:"FAILED",ref:o.ref,msg:"invalid ticket"}));break}var c=o.userId;if((null==n||""===n)&&(n=e.cookie("user_id")),null==n||""===n){E.socket.postMessage(JSON.stringify({op:"getUserData",status:"FAILED",ref:o.ref,msg:"invalid userId"}));break}E.getUserData(o.appId,o.genomeId,i,c,function(e){e.success?E.socket.postMessage(JSON.stringify({op:"getUserData",status:"OK",ref:o.ref,userData:e.data})):E.socket.postMessage(JSON.stringify({op:"getUserData",status:"FAILED",ref:o.ref,msg:null!=e.error?e.error.message:""}))});break;case"triggerEmailActivation":(null==o.sessionId||""===o.sessionId)&&E.socket.postMessage(JSON.stringify({op:"triggerEmailActivation",status:"FAILED",ref:o.ref,data:"sessionId is required"})),(null==o.ticket||""===o.sessionId)&&E.socket.postMessage(JSON.stringify({op:"triggerEmailActivation",status:"FAILED",ref:o.ref,data:"ticket is required"})),E.triggerEmailActivation(o.appId,o.genomeId,o.ticket,o.sessionId,function(e){e.success?E.socket.postMessage(JSON.stringify({op:"triggerEmailActivation",status:"OK",ref:o.ref,data:e.data})):E.socket.postMessage(JSON.stringify({op:"triggerEmailActivation",status:"FAILED",ref:o.ref,data:e.error}))});break;case"setTicket":E.validateTicket(o.appId,o.genomeId,o.ticket,o.token,function(e){e.success?E.socket.postMessage(JSON.stringify({op:"setTicket",status:"OK",ref:o.ref,ticket:e.data.ticket,token:e.data.token,sessionId:e.data.sessionId})):E.socket.postMessage(JSON.stringify({op:"setTicket",status:"FAILED",ref:o.ref,msg:null!=e.error?e.error.message:""}))});break;case"logout":var a=o.ticket;(null==a||""===a||a===t)&&(a=e.cookie("ticket")),E.logout(o.appId,o.genomeId,a,function(e){e.success?E.socket.postMessage(JSON.stringify({op:"logout",status:"OK",ref:o.ref})):E.socket.postMessage(JSON.stringify({op:"logout",status:"FAILED",ref:o.ref,msg:e.error.message}))})}},s)}}),i()}function d(t){e.ajax({url:"/default/CheckThird",cache:!1,type:"GET",contentType:"application/json; charset=utf-8",success:function(s){var o=e.cookie("thirdPartyOk");t({success:!0,data:o})},error:function(e){var s=null;try{s=JSON.parse(e.responseText)}catch(o){console.warn("getProfile"),console.warn(e),console.warn(o)}t({success:!1,error:s})}})}function p(t,s,o,r){e.ajax({url:E.endpoint+"v3/profiles/me",cache:!1,type:"GET",contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Ubi-AppId",t),null!=s&&""!==s&&e.setRequestHeader("GenomeId",s),e.setRequestHeader("Authorization","Ubi_v1 t="+o)},success:function(e){r({success:!0,data:e})},error:function(e){var t=null;try{t=JSON.parse(e.responseText)}catch(s){console.warn("getProfile"),console.warn(e),console.warn(s)}r({success:!1,error:t})}})}function g(t,s,o,r,a){e.ajax({url:E.endpoint+"v3/profiles?userId="+r,cache:!1,type:"GET",contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Ubi-AppId",t),null!=s&&""!==s&&e.setRequestHeader("GenomeId",s),e.setRequestHeader("Authorization","Ubi_v1 t="+o)},success:function(e){a({success:!0,data:e})},error:function(e){var t=null;try{t=JSON.parse(e.responseText)}catch(s){console.warn("getProfiles"),console.warn(e),console.warn(s)}a({success:!1,error:t})}})}function m(t,s,r,a,n){e.ajax({url:E.endpoint+"v3/users/startActivation",cache:!1,type:"POST",data:JSON.stringify({}),contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Ubi-AppId",t),null!=s&&""!==s&&e.setRequestHeader("GenomeId",s),e.setRequestHeader("Authorization","Ubi_v1 t="+r),e.setRequestHeader("Ubi-SessionId",a)},success:function(t){try{o({ACTION:"Email Verification â€“ Resend an email Successfull",SITESECTION:"Account pages",SUBSITESECTION:"Email Verification",COUNTRY:E.country,LANGUAGE:E.lang,UPLAYID:e.cookie("user_id")}),n({success:!0,data:{sent:!0}})}catch(s){n({success:!1,error:{message:"unable send activation email"}})}},error:function(e){var t=null;try{t=JSON.parse(e.responseText)}catch(s){console.warn("triggerEmailActivation"),console.warn(e),console.warn(s)}n({success:!1,error:t})}})}function k(t,s,o,r,a){e.ajax({url:E.endpoint+"v3/users/"+r,cache:!1,type:"GET",contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Ubi-AppId",t),null!=s&&""!==s&&e.setRequestHeader("GenomeId",s),e.setRequestHeader("Authorization","Ubi_v1 t="+o)},success:function(e){try{a({success:!0,data:{status:{generalStatus:e.status.generalStatus}}})}catch(t){a({success:!1,error:{message:"unable to get general status"}})}},error:function(e){var t=null;try{t=JSON.parse(e.responseText)}catch(s){console.warn("getUserData"),console.warn(e),console.warn(s)}a({success:!1,error:t})}})}function h(e,t){try{var s=e.substring(0,e.indexOf(".")),o=B64.decode(s).replace("\x00",""),r=JSON.parse(o);return r.aid.toLowerCase()===t.toLowerCase()}catch(a){return!1}}function b(s,o,r,a,n,i){e.ajax({url:E.endpoint+"v3/profiles/sessions",type:"PUT",data:JSON.stringify({token:a}),contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Ubi-AppId",s),null!=o&&""!==o&&e.setRequestHeader("GenomeId",o),e.setRequestHeader("Authorization","Ubi_v1 t="+r)},success:function(e){S(e),i({success:!0,data:e})},error:function(e){if(null==n||n==t||window.refreshing){window.refreshing||w();var r=null;try{r=JSON.parse(e.responseText)}catch(a){console.warn("extendTicket"),console.warn(e),console.warn(a)}i({success:!1,error:r})}else E.validateRememberMe(s,o,i)}})}function v(s,o,r,a,n,i){e.ajax({url:E.endpoint+"v3/profiles/sessions",type:"POST",data:JSON.stringify({token:a}),contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Ubi-AppId",s),null!=o&&""!==o&&e.setRequestHeader("GenomeId",o),e.setRequestHeader("Authorization","Ubi_v1 t="+r)},success:function(e){S(e),i({success:!0,data:e})},error:function(e){if(null==n||n==t||window.refreshing){window.refreshing||w();var r=null;try{r=JSON.parse(e.responseText)}catch(a){console.warn("renewTicket"),console.warn(e),console.warn(a)}i({success:!1,error:r})}else E.validateRememberMe(s,o,i)}})}function I(s,o,r,a,n){null==r&&(r=e.cookie("ticket")),null==a&&(a=e.cookie("token"));var i=e.cookie("rememberMeTicket");if(!(null!=r&&r!=t||null!=i&&i!=t))return w(),void n({success:!1,error:null});if(null!=r&&r!=t)E.sameAppId(r,s)?E.extendTicket(s,o,r,a,i,n):E.renewTicket(s,o,r,a,i,n);else{if(null==i||i==t)return w(!0),void n({success:!1,error:null});E.validateRememberMe(s,o,n)}}function T(t,s,o){var r=e.cookie("rememberMeTicket");e.ajax({url:E.endpoint+"v3/profiles/sessions",type:"POST",data:JSON.stringify({rememberMe:!0}),contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Ubi-AppId",t),""!==s&&null!=s&&e.setRequestHeader("GenomeId",s),e.setRequestHeader("Ubi-RequestedPlatformType","uplay"),e.setRequestHeader("Authorization","rm_v1 t="+r)},success:function(e){S(e),o({success:!0,data:e,redirect:!0})},error:function(e,t){"error"==t&&(window.refreshing||w(!0));var s={message:""};try{s=JSON.parse(e.responseText)}catch(r){console.warn("validateRememberMe"),console.warn(r),console.warn(e)}o({success:!1,data:s})}})}function y(t,s,o,r){e.ajax({url:"/api/defaultApi/config/validate",type:"POST",contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Ubi-AppId",t),""!==s&&null!=s&&e.setRequestHeader("GenomeId",s),e.setRequestHeader("Authorization","Ubi_v1 t="+o)},success:function(a){a.ageGatePassed&&r({success:!0,data:a}),a.ageGatePassed||"ageGateNotVerified"!=a.message||e.ajax({url:E.endpoint+"v3/users/"+a.userId,cache:!1,type:"GET",contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Ubi-AppId",t),null!=s&&""!==s&&e.setRequestHeader("GenomeId",s),e.setRequestHeader("Authorization","Ubi_v1 t="+o)},success:function(e){var t;(new Date).getFullYear()-new Date(e.dateOfBirth).getFullYear()>a.ageGateNumber?(t=JSON.stringify({success:!0,ageGatePassed:!0,isValidConfig:!0}),r({success:!0,data:t})):(t=JSON.stringify({success:!0,ageGatePassed:!1,message:"ageGateFailed"}),r({success:!1,data:t}))},error:function(e){var t=JSON.stringify({success:!1,error:{message:"configValidation: unable to get user data for age gate check"}});r({success:!1,error:t})}})},error:function(e){var t=null;try{t=JSON.parse(e.responseText)}catch(s){console.warn("configValidation"),console.warn(e),console.warn(s)}r({success:!1,error:t})}})}function S(s){try{e.cookie("token",s.token,{path:"/",domain:"ubi.com"}),e.cookie("ticket",s.ticket,{path:"/",domain:"ubi.com"}),e.cookie("user_id",s.userId,{path:"/",domain:"ubi.com"}),e.cookie("login",s.username,{path:"/",domain:"ubi.com"}),s.nameOnPlatform!==t&&e.cookie("user_name",s.username,{path:"/",domain:"ubi.com"}),s.hasOwnProperty("rememberMeTicket")&&null!=s.rememberMeTicket&&e.cookie("rememberMeTicket",s.rememberMeTicket,{path:"/",domain:"ubi.com",expires:14}),s.hasOwnProperty("sessionId")&&null!=s.sessionId&&e.cookie("sessionId",s.sessionId,{path:"/",domain:"ubi.com"})}catch(o){}}function w(s){try{e.removeCookie("token",{path:"/",domain:"ubi.com"}),e.removeCookie("ticket",{path:"/",domain:"ubi.com"}),e.removeCookie("user_id",{path:"/",domain:"ubi.com"}),e.removeCookie("sessionId",{path:"/",domain:"ubi.com"}),e.removeCookie("login",{path:"/",domain:"ubi.com"}),e.removeCookie("user_name",{path:"/",domain:"ubi.com"}),s!=t&&(e.removeCookie("rememberMeTicket",{path:"/",domain:"ubi.com",expires:-5}),e.removeCookie("rememberMeTicket",{path:"/",expires:-5}))}catch(o){}}function O(t,s,o,r){e.ajax({url:E.endpoint+"v3/profiles/sessions",type:"DELETE",contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Ubi-AppId",t),null!=s&&""!==s&&e.setRequestHeader("GenomeId",s),e.setRequestHeader("Authorization","Ubi_v1 t="+o)},success:function(t){w(!0),e.removeCookie("rememberMeTicket",{path:"/",domain:"ubi.com",expires:-5}),r({success:!0,data:t})},error:function(t,s){if(w(!0),e.removeCookie("rememberMeTicket",{path:"/",domain:"ubi.com",expires:-5}),"error"==s)var o=null;try{o=JSON.parse(t.responseText)}catch(a){console.warn("logout"),console.warn(t),console.warn(a)}r({success:!1,error:o})}})}function A(e){E.socket.destroy(),e()}function N(e,t){}var E={local:null,swf:null,acl:[],endpoint:null,socket:null,callbacks:[],refreshing:!1,init:f,log:N,createDays:365,expireDays:-100,readC:r,createC:a,deleteC:n,disableLock:c,enableLock:i,isLockEnabled:u,waitForLock:l,logout:O,getProfile:p,getProfiles:g,getUserData:k,sameAppId:h,validateTicket:I,extendTicket:b,renewTicket:v,configValidation:y,validateRememberMe:T,checkThirdParty:d,triggerEmailActivation:m,dispose:A};return e(window).on("beforeunload",function(){E.refreshing=!0,window.refreshing=!0}),E};"function"==typeof define&&define.amd?define("uplay",["jquery"],o):e.uplay=o(jQuery)}(window);var B64={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",lookup:null,ie:/MSIE /.test(navigator.userAgent),ieo:/MSIE [67]/.test(navigator.userAgent),encode:function(e){var t,s,o,r=B64.toUtf8(e),a=-1,n=r.length,i=[,,,];if(k,B64.ie){for(var c=[];++a<n;)t=r[a],s=r[++a],i[0]=t>>2,i[1]=(3&t)<<4|s>>4,isNaN(s)?i[2]=i[3]=64:(o=r[++a],i[2]=(15&s)<<2|o>>6,i[3]=isNaN(o)?64:63&o),c.push(B64.alphabet.charAt(i[0]),B64.alphabet.charAt(i[1]),B64.alphabet.charAt(i[2]),B64.alphabet.charAt(i[3]));return c.join("")}for(var c="";++a<n;)t=r[a],s=r[++a],i[0]=t>>2,i[1]=(3&t)<<4|s>>4,isNaN(s)?i[2]=i[3]=64:(o=r[++a],i[2]=(15&s)<<2|o>>6,i[3]=isNaN(o)?64:63&o),c+=B64.alphabet[i[0]]+B64.alphabet[i[1]]+B64.alphabet[i[2]]+B64.alphabet[i[3]];return c},decode:function(e){var t=B64.fromUtf8(e),s=0,o=t.length;if(B64.ieo){for(var r=[];o>s;)t[s]<128?r.push(String.fromCharCode(t[s++])):t[s]>191&&t[s]<224?r.push(String.fromCharCode((31&t[s++])<<6|63&t[s++])):r.push(String.fromCharCode((15&t[s++])<<12|(63&t[s++])<<6|63&t[s++]));return r.join("")}for(var r="";o>s;)r+=t[s]<128?String.fromCharCode(t[s++]):t[s]>191&&t[s]<224?String.fromCharCode((31&t[s++])<<6|63&t[s++]):String.fromCharCode((15&t[s++])<<12|(63&t[s++])<<6|63&t[s++]);return r},toUtf8:function(e){var t,s=-1,o=e.length,r=[];if(/^[\x00-\x7f]*$/.test(e))for(;++s<o;)r.push(e.charCodeAt(s));else for(;++s<o;)t=e.charCodeAt(s),128>t?r.push(t):2048>t?r.push(t>>6|192,63&t|128):r.push(t>>12|224,t>>6&63|128,63&t|128);return r},fromUtf8:function(e){var t,s=-1,o=[],r=[,,,];if(!B64.lookup){for(t=B64.alphabet.length,B64.lookup={};++s<t;)B64.lookup[B64.alphabet.charAt(s)]=s;s=-1}for(t=e.length;++s<t&&(r[0]=B64.lookup[e.charAt(s)],r[1]=B64.lookup[e.charAt(++s)],o.push(r[0]<<2|r[1]>>4),r[2]=B64.lookup[e.charAt(++s)],64!=r[2])&&(o.push((15&r[1])<<4|r[2]>>2),r[3]=B64.lookup[e.charAt(++s)],64!=r[3]);)o.push((3&r[2])<<6|r[3]);return o}};
//# sourceMappingURL=uplay_xdm134.min.js.map
