// Connect
var a = Math.random() * 10000000000000;

function getScript(source, callback) {
    var script = document.createElement('script');
    var prior = document.getElementsByTagName('script')[0];
    script.async = 1;
    prior.parentNode.insertBefore(script, prior);

    script.onload = script.onreadystatechange = function(_, isAbort) {
        if (isAbort || !script.readyState || /loaded|complete/.test(script.readyState)) {
            script.onload = script.onreadystatechange = null;
            script = undefined;

            if (!isAbort) {
                if (callback) callback();
            }
        }
    };

    script.src = source;
}

// Cookie-reading function
function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
}


var tc_vars = {
    nav: {
        siteCategory: wa_data.siteCategory,
        environment: wa_data.environment,
        siteType: 'Ubiconnect Cross-Platform Service',
        siteName: wa_data.siteName || '',
        pageName: wa_data.pageName,
        siteSubSection: wa_data.siteSubSection,
        country: wa_data.country,
        language: wa_data.language,
        doNotTrack: window.navigator.doNotTrack,
        genomeID: wa_data.genomeID,
        errortype: wa_data.errortype,
        UbiConnectPlatform: wa_data.UbiConnectPlatform,
    },

    profile: {
        uplayID: readCookie("user_id")
    },
}



// loginStatus definition
if (tc_vars.nav.uplayID !== null) {
    tc_vars.nav.loginStatus = '1';
} else {
    tc_vars.loginStatus = '0';
}




if (window.location.href.indexOf("6d3ac1d6-d93b-4894-b74c-ca76ebf97c61") > 0)
{console.log("tracking deactivated")}
else if (typeof tridionSettings !== "undefined") {
    // NCSA
    switch (tridionSettings.values.zone) {
        case "US":
        case "CA":
        case "MX":
        case "BR":
            getScript("//ubistatic2-a.akamaihd.net/worldwide_analytics/tagcommander/UbisoftConnect/wa_data_UbiConnect.js?rand=" + a);
            getScript("//ubistatic2-a.akamaihd.net/worldwide_analytics/tagcommander/js/prod/tc_ncsaworldwidecontainer.js");
            break;
        default:
            // EMEA
            getScript("//ubistatic2-a.akamaihd.net/worldwide_analytics/tagcommander/UbisoftConnect/wa_data_UbiConnect.js?rand=" + a);
            getScript("//ubistatic2-a.akamaihd.net/worldwide_analytics/tagcommander/js/tc_UbiWorldWide_1.js?rand=" + a);
            break;
    }
} else if (typeof wa_data !== "undefined") {
    // NCSA
    switch (wa_data.country) {
        case "US":
        case "CA":
        case "MX":
        case "BR":
            getScript("//ubistatic2-a.akamaihd.net/worldwide_analytics/tagcommander/UbisoftConnect/wa_data_UbiConnect.js?rand=" + a);
            getScript("//ubistatic2-a.akamaihd.net/worldwide_analytics/tagcommander/js/prod/tc_ncsaworldwidecontainer.js");
            break;
            // EMEA
        default:
            getScript("//ubistatic2-a.akamaihd.net/worldwide_analytics/tagcommander/UbisoftConnect/wa_data_UbiConnect.js?rand=" + a);
            getScript("//ubistatic2-a.akamaihd.net/worldwide_analytics/tagcommander/js/tc_UbiWorldWide_1.js?rand=" + a);
            break;
    }
}